{% extends '../base.html' %}

{% block main %}
<a href="/manage/user" class="btn btn-primary" role="button">add</a>
<table class="table table-hover">
    <thead>
    <tr>
        <th>Email</th>
        <th>角色</th>
        <th>operation</th>
    </tr>
    </thead>
    <tbody>
    {% for e in result.rows %}
    <tr>
        <td>{{e.email}}</td>
        <td>
            {% if e.role==0 %}
              普通用户
            {% endif %}
            {% if e.role==1 %}
              高级会员
            {% endif %}
            {% if e.role==9 %}
              管理员
            {% endif %}
        </td>
        <td>
        {% if e.verified==1 %}
            <a href="/manage/user?id={{e.id}}" class="btn btn-warning" role="button">审核</a>  
        {% endif %}
        <a href="/manage/user?id={{e.id}}" class="btn btn-primary" role="button">detail</a>
        <a href="/api/user/{{e.id}}" class="btn btn-danger" role="button">del</a>
        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>
<nav aria-label="Page navigation">
  <ul class="pagination">
  {{page}}
  </ul>
</nav>

{% endblock %}
{% block foot %}

<script>
   
    $(".btn-danger").on("click",function () {
        var thiz=$(this);
        $.ajax({
            type: "DELETE",
            url: this.href,
            dataType:"json",
            success:function(json){
                if(json.code="success"){
                    thiz.parent("li").remove();
                }
            }
        });
    });
</script>
{% endblock %}