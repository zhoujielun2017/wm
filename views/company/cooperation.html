{% extends '../base.html' %}

{% block head %}

{% endblock %}

{% block main %}

<form class="form-horizontal">
  <input type="hidden" name="id" value="{{bean.id}}">

{% for e in customer %}

 <div class="form-group {% if loop.last %}customer{% endif %}" >
      <label for="inputEmail3" class="col-sm-3 control-label">{{__('Brands')}}</label>
      <div class="col-sm-9" >
        <div class="row">
          <!--<div class="col-xs-6 col-sm-4">
            <select class="form-control" name="type">
              <option value="seller" {% if e.type=='seller' %}selected{% endif %}>{{__('seller')}}</option>
              <option value="agency" {% if e.type=='agency' %}selected{% endif %}>{{__('agency')}}</option>
            </select>
          </div>
          -->
          <div class="col-xs-4 col-sm-6">
             <input type="text" name="customer" value="{{e.name}}" class="form-control"  placeholder="{{__('Brand Name')}}">
          </div>
          <div class="col-xs-6 col-sm-4">
                <input type="text" name="co_time" value="{{e.co_time}}" class="form-control"  placeholder="{{__('Year-Year')}}">
          </div>
          <div class="col-xs-2 col-sm-2">
              {% if not loop.first %}
              <button class="btn btn-danger">{{__('Delete')}}</button>
              {% endif %}
          </div>
        </div>
      </div>
    </div>
  {% else %}
  <div class="form-group customer" >
      <label for="inputEmail3" class="col-sm-3 control-label">{{__('Brands')}}</label>
      <div class="col-sm-9" >
        <div class="row">
          <!--<div class="col-xs-6 col-sm-4">
            <select class="form-control" name="type">
              <option value="seller">{{__('seller')}}</option>
              <option value="agency">{{__('agency')}}</option>
            </select>
          </div>-->
          <div class="col-xs-4 col-sm-6">
             <input type="text" name="customer" value="" class="form-control" id="inputEmail3" placeholder="{{__('Brand Name')}}">
          </div>
          <div class="col-xs-6 col-sm-4">
             <input type="text" name="co_time" value="" class="form-control" id="" placeholder="{{__('Year-Year')}}">
          </div>
          <div class="col-xs-2 col-sm-2">
              {% if not loop.first %}
              <button class="btn btn-danger">{{__('Delete')}}</button>
              {% endif %}
          </div>
        </div>
      </div>
    </div>
{% endfor %}

     <div class="form-group">
      <div class="col-sm-offset-3 col-sm-9">
        <a href="javascript:void(0);" class="btn btn-default addC">{{__('Add')}}</a>
      </div>
    </div>


{% for e in factory %}
  
    <div class="form-group {% if loop.last %}factory{% endif %}">
      <label for="inputEmail3" class="col-sm-3 control-label">{{__('Audit Approved Brands')}}</label>
      <div class="col-sm-9" >
          <div class="row">
              <div class="col-xs-4 col-sm-6">
                 <input type="text" name="factory" value="{{e.name}}" class="form-control" id="inputEmail3" placeholder="{{__('Brand Name')}}">
              </div>
               <div class="col-xs-6 col-sm-4">
                    <input type="text" name="co_time" value="{{e.co_time}}" class="form-control" id="" placeholder="{{__('Audit Time')}}">
               </div>
              <div class="col-xs-2 col-sm-2">
                  {% if not loop.first %}
                  <button class="btn btn-danger">{{__('Delete')}}</button>
                  {% endif %}
              </div>
          </div>
      </div>
    </div>
  {% else %}
  <div class="form-group factory">
    <label for="inputEmail3" class="col-sm-3 control-label">{{__('Audit Approved Brands')}}</label>
    <div class="col-sm-9" >
        <div class="row">
            <div class="col-xs-4 col-sm-6">

               <input type="text" name="factory" value="" class="form-control"  placeholder="{{__('Brand Name')}}">
            </div>
              <div class="col-xs-6 col-sm-4">
                  <input type="text" name="co_time" value="" class="form-control"  placeholder="{{__('Audit Time')}}">
              </div>
             <div class="col-xs-2 col-sm-2">
                  <button class="btn btn-danger">{{__('Delete')}}</button>
              </div>
          </div>
      </div>
  </div>
{% endfor %}
 
    <div class="form-group">
      <div class="col-sm-offset-3 col-sm-9">
        <a href="#" class="btn btn-default addF">{{__('Add')}}</a>
      </div>
    </div>

  <div class="form-group">
    <label for="inputEmail3" class="col-sm-3 control-label">{{__('Factory Area')}}</label>
    <div class="col-sm-7">
      <input type="text" name="acreage" value="{{bean.acreage}}" class="form-control divide" id="inputEmail3" placeholder="{{__('Factory Area')}}">
    </div>
    <div class="col-sm-2">
       <p class="form-control-static">{{__('square meters')}}</p>
    </div>
  </div>

    <div class="form-group">
        <label for="inputEmail3" class="col-sm-3 control-label">{{__('Annual Sales')}}</label>
        <div class="col-sm-7">
            <input type="text" name="sale_per_year" value="{{bean.sale_per_year}}" class="form-control divide" id="" placeholder="{{__('Sales Volume/Year')}}">
        </div>
        <div class="col-sm-2">
            <p class="form-control-static">{{__('Dollars')}}</p>
        </div>
    </div>



  <div class="form-group">
    <label for="inputEmail3" class="col-sm-3 control-label">{{__('Development Capacity(Month)')}}</label>
    <div class="col-sm-7">
      <input type="text" name="type_per_month" value="{{bean.type_per_month}}" class="form-control divide" id="inputEmail3" placeholder="{{__('Styles Per Month')}}">
    </div>
     <div class="col-sm-2">
       <p class="form-control-static">{{__('Styles')}}</p>
    </div>
  </div>
    <!--
  <div class="form-group">
    <label for="inputPassword3" class="col-sm-3 control-label">{{__('produce person')}}</label>
    <div class="col-sm-7">
      <input type="text" name="count_person" value="{{bean.count_person}}" class="form-control" placeholder="">
    </div>
     <div class="col-sm-2">
       <p class="form-control-static">{{__('persons')}}</p>
    </div>
  </div>
  
   <div class="form-group">
    <label  class="col-sm-3 control-label">{{__('QC person')}}</label>
    <div class="col-sm-7">
     	<input name="count_qc"  class="form-control" value="{{bean.count_qc}}" />
    </div>
     <div class="col-sm-2">
       <p class="form-control-static">{{__('persons')}}</p>
    </div>
  </div>
  -->
   <div class="form-group">
    <label  class="col-sm-3 control-label">{{__('Production Capacity(Month)')}}</label>
    <div class="col-sm-7">
      <input type="text" name="able_per_month" value="{{bean.able_per_month}}" class="form-control divide" placeholder="{{__('Monthly Production')}}">
    </div>
     <div class="col-sm-2">
       <p class="form-control-static">{{__('Units')}}</p>
    </div>
  </div>
  <div class="form-group">
      <label  class="col-sm-3 control-label">{{__('Production Line')}}</label>
      <div class="col-sm-7">
          <input type="text" name="count_person" value="{{bean.count_person}}" class="form-control"
                 placeholder="{{__('Number of employees')}}">
      </div>
      <div class="col-sm-2">
          <p class="form-control-static">{{__('Persons')}}</p>
      </div>
  </div>
  <div class="form-group">
      <label  class="col-sm-3 control-label">{{__('Sampling Dept')}}</label>
      <div class="col-sm-7">
          <input type="text" name="count_dev" value="{{bean.count_dev}}" class="form-control" placeholder="{{__('Number of employees')}}">
      </div>
      <div class="col-sm-2">
          <p class="form-control-static">{{__('Persons')}}</p>
      </div>
  </div>
  <div class="form-group">
      <label  class="col-sm-3 control-label">{{__('QC Dept')}}</label>
      <div class="col-sm-7">
          <input type="text" name="count_qc" value="{{bean.count_qc}}" class="form-control" placeholder="{{__('Number of employees')}}">
      </div>
      <div class="col-sm-2">
          <p class="form-control-static">{{__('Persons')}}</p>
      </div>
  </div>
  <div class="form-group">
      <label  class="col-sm-3 control-label">{{__('Trading Dept')}}</label>
      <div class="col-sm-7">
          <input type="text" name="count_trade" value="{{bean.count_trade}}" class="form-control"
                 placeholder="{{__('Number of employees')}}">
      </div>
      <div class="col-sm-2">
          <p class="form-control-static">{{__('Persons')}}</p>
      </div>
  </div>
  <div class="form-group">
      <label  class="col-sm-3 control-label">{{__('Produts')}}</label>
      <div class="col-sm-9">
          <div class="btn-group product" role="group">
              {% for e in products %}
              <button type="button" class="btn btn-default  {% for d in bean.product %}{% if  e==d  %}btn-primary{% endif %}{% endfor %}" data-code="{{e}}" >{{__('product_'+e)}}</button>
              {% endfor %}
          </div>
      </div>
  </div>
  <div class="form-group">
    <label  class="col-sm-3 control-label">{{__('Speciality')}}</label>
    <div class="col-sm-9">
      <div class="btn-group major" role="group">
      {% for e in major %}
      <button type="button" class="btn btn-default  {% for d in bean.major %}{% if  e==d  %}btn-primary{% endif %}{% endfor %}" data-code="{{e}}" >{{__('major_'+e)}}</button>
      {% endfor %}
      </div>
    </div>
  </div>
   <input type="hidden" name="types">
   <input type="hidden" name="names">
   <input type="hidden" name="majors">
   <input type="hidden" name="co_times">
   <input type="hidden" name="products">
  <div class="form-group">
    <div class="col-sm-offset-3 col-sm-9">
      <button type="submit" class="btn btn-default">{{__('Confirm')}}</button>
    </div>
  </div>
</form>
{% endblock %}

{% block foot %}
<script>
//major click
$(".major,.product").on("click","button",function(){
  var len=$(".major .btn-primary").length;
  var has=$(this).hasClass("btn-primary");
  // if(len>=3&&!has){
  //   YY.dialog({content:"three choose most"}).alert();
  //   return ;
  // }
  $(this).toggleClass("btn-primary");
});

$(".addC").click(function(){
  var temp=$(".customer");
  var clone=temp.clone();
  temp.after(clone);
  temp.removeClass("customer")
  clone.find("input").val("");
});
$(".addF").click(function(){
  var temp=$(".factory");
  var clone=temp.clone();
  temp.after(clone);
  temp.removeClass("factory")
  clone.find("input").val("");
});
//删除
$(".btn-danger").click(function(){
  $(this).parents(".form-group").remove();
  return false;
});
$("form").on('submit',function(e){

    var $this=$(this)

    //名称
    var names=[],types=[];
    $("input[name=customer]").each(function(){
      types.push("customer");
      names.push($(this).val())
    });
    $("input[name=factory]").each(function(){
        types.push("factory");
        names.push($(this).val())
    })
    //品牌合作时间
    var co_times=[];
    $("input[name=co_time]").each(function(){
      var time=$(this).val();
      // var ms=Date.parse(time)
      co_times.push(time);
    });

    //特长
    var majors=[];
    $(".major .btn-primary").each(function(){
        var code=$(this).data("code");
        majors.push(code);
    })
    //产品
    var products=[];
    $(".product .btn-primary").each(function(){
        var code=$(this).data("code");
        products.push(code);
    })
    $this.find("input[name=types]").val(types.join("_@_"));
    $this.find("input[name=names]").val(names.join("_@_"));
    $this.find("input[name=co_times]").val(co_times.join(","));
    $this.find("input[name=majors]").val(majors.join(","));
    $this.find("input[name=products]").val(products.join(","));

    var data=$this.serialize();
    $.ajax({
        type: "put",
        url: "/api/factorydetail",
         data:data,
        dataType:"json",
        success:function(json){
            if(json.code=='success'){
            	$("input[name=id]").val(json.id);
            	YY.dialog({content:json.code}).alert();
            }else{
            	// location.reload();
            }
        }
    });

    return false;
});
</script>

<script type="text/javascript" src="js/number-divider.min.js"></script>
<script type="text/javascript">
    $(function(){
        var input = $('#input');
        $('.divide').divide();

        $('#range_input').on("input change", function() {
            rangeLabel.val(this.value);
        });
    })
</script>
{% endblock %}